<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Eco-Hogar</title>
  <link rel="stylesheet" href="estilos-Login.css">
</head>
<body>
  
  <!-- ===== LOADER ===== -->
  <div id="loader">
    <!-- From Uiverse.io by Praashoo7 --> 
    <div class="main">
      <div class="up">
        <div class="loaders">
          <div class="loader"></div>
          <div class="loader"></div>
          <div class="loader"></div>
          <div class="loader"></div>
          <div class="loader"></div>
          <div class="loader"></div>
          <div class="loader"></div>
          <div class="loader"></div>
          <div class="loader"></div>
          <div class="loader"></div>
        </div>
        <div class="loadersB">
          <div class="loaderA">
            <div class="ball0"></div>
          </div>
          <div class="loaderA">
            <div class="ball1"></div>
          </div>
          <div class="loaderA">
            <div class="ball2"></div>
          </div>
          <div class="loaderA">
            <div class="ball3"></div>
          </div>
          <div class="loaderA">
            <div class="ball4"></div>
          </div>
          <div class="loaderA">
            <div class="ball5"></div>
          </div>
          <div class="loaderA">
            <div class="ball6"></div>
          </div>
          <div class="loaderA">
            <div class="ball7"></div>
          </div>
          <div class="loaderA">
            <div class="ball8"></div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- ===== CONTENEDOR PRINCIPAL ===== -->
  <div class="layout">
    <!-- LOGO -->
    <div class="logo-contenedor">
      <img src="logo3.png" alt="Logo Eco-Hogar" class="logo">
    </div>

    <!-- LOGIN -->
    <section class="login">
      <div class="contenedor">
          <h1>Iniciar Sesión</h1>
          <form id="loginForm">
            <input type="text" id="username" placeholder="Usuario" required>
            <input type="password" id="password" placeholder="Contraseña" required>
            <input type="submit" value="Ingresar">
          </form>
          <div id="mensaje" class="mensaje"></div>
      </div>
    </section>
  </div>
  
  
<!-- ======= LOADER Y LOGIN SCRIPT ======= -->
<script>
  // Ocultar el loader cuando se cargue la página
  window.addEventListener("load", () => {
    const loader = document.getElementById("loader");
    if (loader) {
      setTimeout(() => {
        loader.style.opacity = "0";
        loader.style.transition = "opacity 0.5s ease";
        setTimeout(() => {
          loader.style.display = "none";
        }, 500);
      }, 1000); // se oculta rápido, puedes ajustar
    }
  });

  // Manejo del formulario de login
  document.getElementById("loginForm").addEventListener("submit", function(event) {
    event.preventDefault(); // evita que se recargue la página

    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value.trim();
    const mensaje = document.getElementById("mensaje");

    // Leer usuarios desde localStorage
    const usuarios = JSON.parse(localStorage.getItem("usuarios")) || [];

    // Buscar usuario válido
    const usuarioEncontrado = usuarios.find(u => u.nombre === username && u.password === password);

    if (usuarioEncontrado) {
      mensaje.textContent = "✅ Login exitoso, bienvenido " + username;
      mensaje.className = "mensaje exito";
      mensaje.style.display = "block";

      // Redirigir según el rol
      setTimeout(() => {
        if (usuarioEncontrado.rol === "admin") {
          window.location.href = "Principal-admin.html";
        } else {
          window.location.href = "Principal-user.html";
        }
      }, 1500);
    } else {
      mensaje.textContent = "❌ Usuario o contraseña incorrectos";
      mensaje.className = "mensaje error";
      mensaje.style.display = "block";

      setTimeout(() => {
        mensaje.style.display = "none";
      }, 3000);

      // Limpia la contraseña para mayor seguridad
      document.getElementById("password").value = "";
    }
  });
</script>
